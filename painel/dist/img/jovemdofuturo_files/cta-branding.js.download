!function(){try{var t="1.0.31",e="cta-branding",a=29,r=104,n=22,i={},o=0,s=Math.random()<.05,l=null,d=document.createElement("canvas");if("cta-test"===e){var f={};try{for(var c=window.location.href.split("?")[1].split("&"),u=0;u<c.length;u++){var m=c[u],v=m.split("=")[0],p=m.split("=")[1];f[v]=p}}catch(t){console.error("*** had issues while reading url parameters")}}function b(t,e,a){var r=window.getComputedStyle(t);if(!r[e])return a||null;var n=parseInt(r[e]);return isNaN(n)?r[e]:n}i.hooks={"item-renderer":function(a,r,n){if(!l){var i=a.rbox;i.formatsData=i.formatsData||{},a.formatsData=a.formatsData||{},a.formatsData.sendAbTestEvent=function(a,r,n){if(!s)return;var i={itemId:this.formatsData.itemId,rating:this.formatsData.rating,price:this.formatsData.price,text:this.formatsData.actionText,type:null!=r?r:"event",description:n,module:e,version:t,event:a,cardIndexOnPage:this.formatsData.cardIndex,index:this.formatsData.index,placement:this.formatsData.placement};window.TRCImpl.sendAbTestEvent("CTA",JSON.stringify(i)),window.TRCImpl.sendAbTestEvent(e,a)}.bind(a),a.formatsData.cardIndex=o++,a.formatsData.index=r.itemIndex,a.formatsData.placement=i.placement,a.formatsData.itemId=(r["item-id"]||r.id||"").slice(0,40);var d,c=r["cta-text"],u=r.fpr||r["cta-price"],m=r["stars-rating"];if(null==l){var v=n&&n.globalTrcResponseJSON&&n.globalTrcResponseJSON.dcga&&n.globalTrcResponseJSON.dcga.pubConfigOverride&&n.globalTrcResponseJSON.dcga.pubConfigOverride["disable-cta-on-custom-module"];a.formatsData.sendAbTestEvent(v?"disable_custom":"enable_custom");var p=window.TRCImpl&&window.TRCImpl.global&&window.TRCImpl.global["disable-cta-on-custom-module"];if(a.formatsData.sendAbTestEvent(p?"disable_global":"enable_global"),p||v)return void(l=!0);l=!1}if("cta-test"===e){var g=Math.random(),_="true"===f["cta-rating"],h="true"===f["cta-always"],x=2+(_?1:0);_&&g>2/x||u||m?(c=c||"Download Today Today",m=parseFloat(m)||5*Math.random(),u=u||"4$"):(g>1/x||h)&&(c=decodeURIComponent(f["cta-text"])||c||"Learn More")}if(c)if(a.formatsData.sendAbTestEvent("has_cta_text"),function(t,e,a){if(!e.isSyndicated||e["is-in-network"])return t.formatsData.sendAbTestEvent("filtered_non_sc"),!1;if(a.options&&a.options.trcResponse&&a.options.trcResponse.nup)return t.formatsData.sendAbTestEvent("filtered_next_up"),!1;var r=!window.TRCImpl||!window.TRCImpl.global||function(t,e){if(null==t)return e;return t}(window.TRCImpl.global["enable-cta-with-description"],!0);if(e.description&&!r)return t.formatsData.sendAbTestEvent("filterd_item_with_description"),!1;var n=t.detail_order;if(n&&n.length&&"branding"===n[0])return t.formatsData.sendAbTestEvent("filterd_item_branding_before_title"),!1;if(!t.link)return t.formatsData.sendAbTestEvent("filtered_no_title"),!1;var i=t.querySelector(".video-label-box");if(!i)return t.formatsData.sendAbTestEvent("filtered_no_video_label_box"),!1;var o=i.querySelector(".branding");if(!o)return t.formatsData.sendAbTestEvent("filtered_no_branding"),!1;var s=b(o,"position");if(s&&"absolute"===s)return t.formatsData.sendAbTestEvent("filtered_branding_absolute_position_item_renderer"),!1;var l=o.querySelector(".branding-inner");if(l){var d=b(l,"position");if(d&&"absolute"===d)return t.formatsData.sendAbTestEvent("filtered_branding_inner_absolute_position"),!1}var f=t.getBoundingClientRect().width;if(f>0&&f<170)return t.formatsData.sendAbTestEvent("filtered_below_min_width"),!1;if(t.rbox.mode_name&&t.rbox.mode_name.indexOf("hero")>-1)return t.formatsData.sendAbTestEvent("filtered_item_in_hero_widget"),!1;if(t.rbox.container.querySelector(".story-widget"))return t.formatsData.sendAbTestEvent("filterd_item_in_reco_reel_story_widget"),!1;if(t.classList.contains("tbl-next-up-widget-item"))return t.formatsData.sendAbTestEvent("filterd_item_next_up"),!1;return!0}(a,r,n))a.formatsData.shouldRenderAsCTA=!0,a.formatsData.actionText=c.slice(0,15),a.formatsData.price=u,m&&(a.formatsData.rating=(d=m,Math.round(2*d)/2)),a.formatsData.isAppInstall=function(t){if(!t.formatsData.rating&&!t.formatsData.price)return!1;return!0}(a),a.formatsData.isAppInstall?a.formatsData.sendAbTestEvent("cta_app_render_candidate"):a.formatsData.sendAbTestEvent("cta_render_candidate"),i.formatsData.isInit||(i.formatsData.isInit=!0,i.formatsData.hasCTAItem=!0,i.formatsData.isStream=function(t){return"autowidget-template-stream"===t.trc.getProperty(t.mode_name,"widget-creator-layout",t.propertiesOverride)}(i),i.formatsData.shouldAdjustAllItemsHeight=!i.formatsData.isStream&&!function(t){var e=t.getEffectiveResponsiveRule();if(e&&1===e.cells)return!0;return!1}(i))}},"list-suffix":function(t,e){if(!l){var i=e.boxes,o=!1,s=0;i.forEach(function(t){try{var a=t.rbox.formatsData;if(!a||!a.hasCTAItem)return;if(!t.formatsData.shouldRenderAsCTA&&!a.shouldAdjustAllItemsHeight)return;var n=t.querySelector(".video-label-box");if(!n)return void t.formatsData.sendAbTestEvent("filtered_no_videoLabelBox_list_suffix");var i=n.querySelector(".branding");if(!i)return void t.formatsData.sendAbTestEvent("filtered_no_branding_list_suffix");if(t.formatsData.shouldRenderAsCTA&&t.formatsData.isAppInstall&&function(t,e,a){t.formatsData.sendAbTestEvent("renderedAppInstall");var r=function(t){var e=document.createElement("span");if(e.classList.add("video-branding-flex-cta-rating"),t.formatsData.price){var a=document.createElement("span");a.innerText=t.formatsData.price,a.classList.add("video-branding-flex-cta-price-wrapper"),e.appendChild(a)}if(t.formatsData.price&&t.formatsData.rating){var r=document.createElement("span");r.classList.add("video-branding-flex-cta-oval-wrapper");var n='<svg class="cta-rating-oval"  width="3px" height="3px" viewBox="0 0 3 3" version="1.1" xmlns="http://www.w3.org/2000/svg">    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">        <g transform="translate(-172.000000, -485.000000)" fill="#666666" fill-rule="nonzero">            <circle cx="173.5" cy="486.5" r="1.5"></circle>        </g>    </g></svg>';r.insertAdjacentHTML("beforeend",n),e.appendChild(r)}if(t.formatsData.rating){for(var i=t.formatsData.cardIndex,o=document.createElement("span"),s=0;s<5;s++){var l=Math.min(Math.max(t.formatsData.rating-s,0),1),d=f(i,s,l);o.insertAdjacentHTML("beforeend",d)}o.classList.add("video-branding-flex-cta-stars-wrapper"),e.appendChild(o)}return e}(t);e.insertBefore(r,a)}(t,n,i),a.shouldAdjustAllItemsHeight&&(s=Math.max(s,c(t,n,i))),t.formatsData.shouldRenderAsCTA){var l=b(i,"position");if(l&&"absolute"===l)return void t.formatsData.sendAbTestEvent("filtered_branding_absolute_position_list_suffix");var m,v=function(t){return b(t,"width")-r}(n)||0,p=b(i,"font-weight"),g=b(i,"font-size"),_=b(i,"font-family");try{m=function(t,e,a,r,n){if(null==e||""===e)return null;if(null==r&&(null==n||""===n))return null;if(null==d)return t.formatsData.sendAbTestEvent("measureText_no_canvas"),null;var i=d.getContext("2d");if(null==i)return t.formatsData.sendAbTestEvent("measureText_no_canvas_context"),null;var o=[];if(null!=a&&o.push(a.toString()),null!=r&&o.push(r+"px"),null!=n&&o.push(n),0===o.length)return t.formatsData.sendAbTestEvent("measureText_no_font_parts"),null;var s=o.join(" ");if(null==s||""===s)return t.formatsData.sendAbTestEvent("measureText_empty_font_value"),null;i.font=s;var l=i.measureText(e);if(null==l)return t.formatsData.sendAbTestEvent("measureText_no_metrics"),null;return l.width}(t,t.video_data["branding-text"],p,g,_)||0}catch(e){return void t.formatsData.sendAbTestEvent("filtered_error_measure_text_list_suffix")}if(m>=v)return void t.formatsData.sendAbTestEvent("filtered_large_branding_width_list_suffix");if((function(t){var e=t.querySelector(".branding-inner"),a=t.querySelector(".branding-separator"),r=t.querySelector(".logoDiv"),n=e&&TRC.dom.getOuterWidth(e)||0,i=a&&TRC.dom.getOuterWidth(a)||0,o=r&&TRC.dom.getOuterWidth(r)||0;return n+i+o}(i)||0)>=v)return void t.formatsData.sendAbTestEvent("filtered_large_branding_parts_width_list_suffix");o=!0,function(t,e,a){t.formatsData.sendAbTestEvent("rendered");var r=function(t,e){var a=document.createElement("a"),r=function(t,e){var a=document.createElement("Button");a.type="button",a.classList.add("video-cta-button","video-cta-style"),a.innerText=t.formatsData.actionText;var r=b(e,"color");r&&(a.style.color=r);return a}(t,e);return a.classList.add("video-cta-href"),a.target="_blank",a.href=function(t){var e,a=t.link,r=t.rbox;if(r.shiftRedirOnclick)e=a.logger_url;else{var n=r.attachHeatMapDataToLink(a.logger_url,null);e=n}return e+="&cta=true"}(t),a.ctaButton=r,a.appendChild(r),a}(t,a);(function(t,e,a,r){var n=function(t){var e=u(t);return!e||!t.link||t.link===e}(e)?e.link:u(e);n&&n.classList.add("video-cta-style"),!e.rbox.isFeedCard&&n&&n.classList.add("non-feed-cta-item"),a&&a.classList.add("video-label-box-cta"),a&&!TRC.Browser.ie&&a.classList.add("video-label-box-cta-non-ie");var i=a.querySelectorAll(".video-label");if(i)for(var o=0;o<i.length;o++){var s=i[o];s.classList.add("video-label-flex-cta-item")}r&&function(t,e,a){if(e.classList.add("video-branding-flex-cta-item"),t.rbox.formatsData.isStream){var r=b(e,"margin-top");r?a.style.marginTop=r+1+"px":e.classList.add("video-branding-flex-cta-item-no-stream")}else e.classList.add("video-branding-flex-cta-item-no-stream");e.style.order=1}(e,r,t),a.appendChild(t)})(r,t,e,a),function(t,e){e.onclick=function(){t.formatsData.sendAbTestEvent("cta_button_clicked")}}(t,r.ctaButton)}(t,n,i),n.classList.contains("video-label-box-cta")&&function(t,e){if(t.fixResponsiveBoxTitleAndDesc(e),window.TRC.dom.on(window,"resize",function(){t.fixResponsiveBoxTitleAndDesc(e)}),e.video_data){var a=t.getDetailSpansFromLabelsBoxes("branding",e);a.length&&setTimeout(function(){for(var r=0;r<a.length;r++)t.fixBoxOverflow(a[r],e.video_data["branding-text"],!0,!0)},0)}}(e,t)}}catch(e){throw t.formatsData.sendAbTestEvent(e.message,"error",e.stack.split("\n",2)[1].trim()),e}}),o&&i.forEach(function(t){!function(t,e){var a=t.querySelector(".video-label-box");if(t.rbox.formatsData.shouldAdjustAllItemsHeight){if(e<=0)return;return void(a.style.height=e+"px")}var r=a.querySelector(".branding"),n=c(t,a,r);if(n>0){a.style.height=n+"px";var i=b(a,"max-height",0);i>0&&i<n&&(a.style.maxHeight=n+"px")}}(t,s)})}function f(t,e,a){return'<svg class="cta-rating-star" height="9px" version="1.1" viewBox="0 0 9 9" width="9px" xmlns="http://www.w3.org/2000/svg">    <g fill="none" fill-rule="evenodd" stroke="none" stroke-width="1">        <linearGradient id="lg'+e+"-"+t+'" x1="0" x2="1" y1="0.5" y2="0.5">            <stop offset="0" stop-color="#737373" stop-opacity="1"/>            <stop offset="'+a+'" stop-color="#737373" stop-opacity="1"/>            <stop offset="'+a+'" stop-color="#737373" stop-opacity="0.5"/>            <stop offset="1" stop-color="#737373" stop-opacity="0.5"/>        </linearGradient>        <g fill="url(#lg'+e+"-"+t+')" fill-rule="nonzero" transform="translate(-21.000000, -19.000000)">            <polygon points="25.5 26.4626165 22.7188471 28 23.25 24.7437694 21 22.4376941 24.1094235 21.9626165 25.5 19 26.8905765 21.9626165 30 22.4376941 27.75 24.7437694 28.2811529 28"></polygon>        </g>    </g></svg>'}function c(t,e,r){var i=b(e,"height");if(i<=0)return 0;if(!t.formatsData.shouldRenderAsCTA)return 0;var o=i+(t.formatsData.isAppInstall?n:0)-r.clientHeight+Math.max(a,r.clientHeight);return o<=i?0:o}function u(t){return t.querySelector(".item-label-href")}}},window.TRC.customHooks[e]=i}catch(t){window.__trcError("Error in CTA module: "+t.message)}}();
